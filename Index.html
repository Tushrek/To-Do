<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimalist To-Do</title>
    <style>
        /* --- General & Layout --- */
        :root {
            --bg-color: #f4f4f9;
            --sidebar-bg: #ffffff;
            --main-bg: #ffffff;
            --text-color: #333;
            --text-light: #888;
            --border-color: #e0e0e0;
            --accent-color: #007bff;
            --accent-hover: #0056b3;
            --danger-color: #dc3545;
            --danger-hover: #c82333;
            --success-color: #28a745;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 25px;
            background-color: var(--sidebar-bg);
            border-bottom: 1px solid var(--border-color);
        }
        .header h1 {
            font-size: 22px;
            margin: 0;
        }
        #date-time {
            font-size: 14px;
            color: var(--text-light);
            font-weight: 500;
        }
        .app-container {
            display: flex;
            flex-grow: 1;
        }

        /* --- Sidebar (Groups & Lists) --- */
        .sidebar {
            width: 280px;
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        .sidebar-content {
            flex-grow: 1;
        }
        .sidebar .add-group-btn {
            width: 100%;
            padding: 10px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            margin-top: 20px;
            transition: background-color 0.2s;
        }
        .sidebar .add-group-btn:hover {
            background-color: var(--accent-hover);
        }
        .group-item {
            margin-bottom: 15px;
        }
        .group-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            font-size: 16px;
            padding: 5px 0;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 5px;
        }
        .group-header span { cursor: default; }
        .list-container {
            list-style: none;
            padding-left: 10px;
        }
        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 15px;
        }
        .list-item:hover {
            background-color: var(--bg-color);
        }
        .list-item.active {
            background-color: var(--accent-color);
            color: white;
            font-weight: bold;
        }
        .list-item.active:hover {
             background-color: var(--accent-hover);
        }
        .icon {
            cursor: pointer;
            padding: 4px;
            border-radius: 3px;
            font-size: 14px;
            line-height: 1;
            margin-left: 5px;
            opacity: 0.5;
            transition: opacity 0.2s, background-color 0.2s;
        }
        .icon:hover { opacity: 1; background-color: #ddd; }
        .list-item.active .icon:hover { background-color: var(--accent-hover); }
        .icon.add-list { color: var(--success-color); }
        .icon.delete { color: var(--danger-color); }

        /* --- Main Content (Tasks) --- */
        .main-content {
            flex-grow: 1;
            padding: 20px 40px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }
        .main-content h2 {
            margin-top: 0;
            font-size: 28px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
        }
        .placeholder {
            text-align: center;
            color: var(--text-light);
            margin-top: 50px;
            font-size: 18px;
        }
        #task-form {
            display: flex;
            margin-bottom: 20px;
        }
        #task-input {
            flex-grow: 1;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px 0 0 5px;
            font-size: 16px;
        }
        #task-form button {
            padding: 12px 20px;
            border: none;
            background-color: var(--accent-color);
            color: white;
            border-radius: 0 5px 5px 0;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }
        #task-form button:hover {
            background-color: var(--accent-hover);
        }
        #task-list {
            list-style: none;
            padding: 0;
        }
        .task-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.2s;
        }
        .task-item:hover {
            background-color: var(--bg-color);
        }
        .task-item input[type="checkbox"] {
            margin-right: 15px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        .task-text {
            flex-grow: 1;
            cursor: pointer;
        }
        .task-item.completed .task-text {
            text-decoration: line-through;
            color: var(--text-light);
        }
        .task-item .delete-task {
            opacity: 0;
            transition: opacity 0.2s;
        }
        .task-item:hover .delete-task {
            opacity: 0.5;
        }
        .task-item .delete-task:hover {
            opacity: 1;
            color: var(--danger-hover);
        }
    </style>
</head>
<body>

    <header class="header">
        <h1>To-Do</h1>
        <div id="date-time"></div>
    </header>

    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-content" id="sidebar-content">
                </div>
            <button class="add-group-btn" id="add-group-btn">＋ Add New Group</button>
        </aside>

        <main class="main-content" id="main-content">
            <div class="placeholder">Select a list to get started, or create a new one.</div>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- STATE MANAGEMENT ---
    let data = [];
    let activeListId = null;

    // --- DOM ELEMENTS ---
    const sidebarContent = document.getElementById('sidebar-content');
    const mainContent = document.getElementById('main-content');
    const addGroupBtn = document.getElementById('add-group-btn');
    const dateTimeEl = document.getElementById('date-time');

    // --- LOCAL STORAGE ---
    function saveData() {
        localStorage.setItem('todoData', JSON.stringify({ data, activeListId }));
    }

    function loadData() {
        const savedState = JSON.parse(localStorage.getItem('todoData'));
        if (savedState) {
            data = savedState.data || [];
            activeListId = savedState.activeListId || null;
        } else {
            // Default state for first-time users
            data = [{
                id: `group-${Date.now()}`,
                name: 'My Day',
                lists: [{ id: `list-${Date.now()}`, name: 'To Do', tasks: [] }]
            }];
            activeListId = data[0].lists[0].id;
        }
    }

    // --- UTILITIES ---
    const createId = (prefix) => `${prefix}-${Date.now()}-${Math.random().toString(16).slice(2)}`;

    // --- RENDERING ---
    function render() {
        renderSidebar();
        renderMainContent();
        saveData();
    }

    function renderSidebar() {
        sidebarContent.innerHTML = '';
        if (data.length === 0) {
            sidebarContent.innerHTML = '<p style="color: #888; text-align:center;">Create a group to begin.</p>';
        }
        data.forEach(group => {
            const groupEl = document.createElement('div');
            groupEl.className = 'group-item';
            groupEl.innerHTML = `
                <div class="group-header">
                    <span>${group.name}</span>
                    <div>
                        <span class="icon add-list" data-group-id="${group.id}">＋</span>
                        <span class="icon delete delete-group" data-group-id="${group.id}">✕</span>
                    </div>
                </div>
                <ul class="list-container" id="list-container-${group.id}"></ul>
            `;
            sidebarContent.appendChild(groupEl);

            const listContainer = groupEl.querySelector(`#list-container-${group.id}`);
            group.lists.forEach(list => {
                const listEl = document.createElement('li');
                listEl.className = `list-item ${list.id === activeListId ? 'active' : ''}`;
                listEl.dataset.listId = list.id;
                listEl.innerHTML = `
                    <span>${list.name}</span>
                    <span class="icon delete delete-list" data-list-id="${list.id}">✕</span>
                `;
                listContainer.appendChild(listEl);
            });
        });
    }

    function renderMainContent() {
        mainContent.innerHTML = '';
        const activeList = findListById(activeListId);

        if (!activeList) {
            mainContent.innerHTML = '<div class="placeholder">Select a list to get started, or create a new one.</div>';
            return;
        }

        mainContent.innerHTML = `
            <h2>${activeList.name}</h2>
            <form id="task-form">
                <input type="text" id="task-input" placeholder="Add a new task..." autocomplete="off" required>
                <button type="submit">Add</button>
            </form>
            <ul id="task-list"></ul>
        `;

        const taskListEl = document.getElementById('task-list');
        if(activeList.tasks.length === 0) {
             taskListEl.innerHTML = '<p style="color: #888; text-align:center;">No tasks yet. Add one above!</p>';
        } else {
            activeList.tasks.forEach(task => {
                const taskEl = document.createElement('li');
                taskEl.className = `task-item ${task.completed ? 'completed' : ''}`;
                taskEl.dataset.taskId = task.id;
                taskEl.innerHTML = `
                    <input type="checkbox" ${task.completed ? 'checked' : ''}>
                    <span class="task-text">${task.text}</span>
                    <span class="icon delete delete-task">✕</span>
                `;
                taskListEl.appendChild(taskEl);
            });
        }
    }

    // --- DATA MANIPULATION ---
    function findListById(listId) {
        if (!listId) return null;
        for (const group of data) {
            const list = group.lists.find(l => l.id === listId);
            if (list) return list;
        }
        return null;
    }
    
    function findGroupAndListById(listId) {
        if (!listId) return { group: null, list: null, groupIndex: -1, listIndex: -1 };
        for (let i = 0; i < data.length; i++) {
            const listIndex = data[i].lists.findIndex(l => l.id === listId);
            if (listIndex !== -1) {
                return { group: data[i], list: data[i].lists[listIndex], groupIndex: i, listIndex: listIndex };
            }
        }
        return { group: null, list: null, groupIndex: -1, listIndex: -1 };
    }

    // --- EVENT HANDLERS ---
    // Add Group
    addGroupBtn.addEventListener('click', () => {
        const groupName = prompt('Enter new group name:');
        if (groupName && groupName.trim()) {
            data.push({
                id: createId('group'),
                name: groupName.trim(),
                lists: []
            });
            render();
        }
    });
    
    // Using event delegation for dynamic elements
    sidebarContent.addEventListener('click', e => {
        // Add List
        if (e.target.classList.contains('add-list')) {
            const groupId = e.target.dataset.groupId;
            const listName = prompt('Enter new list name:');
            if (listName && listName.trim()) {
                const group = data.find(g => g.id === groupId);
                if (group) {
                    const newList = { id: createId('list'), name: listName.trim(), tasks: [] };
                    group.lists.push(newList);
                    activeListId = newList.id; // Make the new list active
                    render();
                }
            }
        }
        // Delete Group
        else if (e.target.classList.contains('delete-group')) {
            const groupId = e.target.dataset.groupId;
            if (confirm('Are you sure you want to delete this group and all its lists?')) {
                const { group } = findGroupAndListById(activeListId);
                if (group && group.id === groupId) {
                    activeListId = null; // Clear active list if it was in the deleted group
                }
                data = data.filter(g => g.id !== groupId);
                if (!activeListId && data.length > 0 && data[0].lists.length > 0) {
                   activeListId = data[0].lists[0].id; // Fallback to first available list
                }
                render();
            }
        }
        // Select List
        else if (e.target.closest('.list-item')) {
            const listItem = e.target.closest('.list-item');
            if (e.target.classList.contains('delete-list')) {
                 // Delete List
                const listIdToDelete = listItem.dataset.listId;
                 if (confirm('Are you sure you want to delete this list?')) {
                    const { group, listIndex } = findGroupAndListById(listIdToDelete);
                    if (group) {
                        group.lists.splice(listIndex, 1);
                        if (activeListId === listIdToDelete) {
                           activeListId = (group.lists.length > 0) ? group.lists[0].id : null;
                        }
                        if (!activeListId && data.length > 0 && data[0].lists.length > 0) {
                            activeListId = data[0].lists[0].id; // Fallback
                        }
                    }
                    render();
                }
            } else {
                activeListId = listItem.dataset.listId;
                render();
            }
        }
    });

    mainContent.addEventListener('submit', e => {
        if (e.target.id === 'task-form') {
            e.preventDefault();
            const taskInput = document.getElementById('task-input');
            const taskText = taskInput.value.trim();
            if (taskText && activeListId) {
                const activeList = findListById(activeListId);
                if (activeList) {
                    activeList.tasks.push({ id: createId('task'), text: taskText, completed: false });
                    taskInput.value = '';
                    render();
                }
            }
        }
    });

    mainContent.addEventListener('click', e => {
        const taskItem = e.target.closest('.task-item');
        if (!taskItem) return;
        const taskId = taskItem.dataset.taskId;
        const activeList = findListById(activeListId);
        if (!activeList) return;
        const task = activeList.tasks.find(t => t.id === taskId);
        if (!task) return;

        // Toggle Complete
        if (e.target.type === 'checkbox') {
            task.completed = e.target.checked;
            render();
        }
        // Delete Task
        else if (e.target.classList.contains('delete-task')) {
            activeList.tasks = activeList.tasks.filter(t => t.id !== taskId);
            render();
        }
        // Edit Task
        else if (e.target.classList.contains('task-text')) {
            const newText = prompt('Edit task:', task.text);
            if (newText !== null && newText.trim() !== '') {
                task.text = newText.trim();
                render();
            }
        }
    });

    // --- DATE & TIME ---
    function updateDateTime() {
        const now = new Date();
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };
        dateTimeEl.textContent = now.toLocaleDateString('en-US', options);
    }
    
    // --- INITIALIZATION ---
    loadData();
    render();
    updateDateTime();
    setInterval(updateDateTime, 1000 * 30); // Update every 30 seconds
});
</script>

</body>
</html>